import{d as O,l as h,aG as U,r as F,o as c,c as u,q as e,w as l,a1 as V,Y as v,a6 as x,$ as k,s as t,a7 as b,aJ as G,E as J,n as s,ae as M,af as j,y as p,G as q,F as _,a as w,b as Y,aM as z,aa as S}from"./main-27bf03b5.js";import{V as A}from"./VCombobox-2660c3a9.js";import"./filter-85954aca.js";const H=s("h6",{class:"text-h6"},"Report Options",-1),K={class:"d-flex flex-column justify-end"},P={style:{display:"inline"}},Q={style:{"overflow-x":"scroll","scrollbar-width":"none"}},W={class:"text-h6"},X=s("h6",{class:"text-body-1"},[s("b")],-1),Z=s("th",null," [Code] Description ",-1),aa=s("th",null," Total ",-1),la=O({__name:"indicators",setup(ea){const y=h(!0),m=h([]),T=h(),r=h({barangay:[],indicator:void 0}),f=h([]),E=async()=>{try{const n=await S.get("api/lookup");T.value=n.data.map(a=>({lookup_name:`[${a.column_number}] ${a.lookup_name}`,id:a.id}))}catch(n){console.error(n)}},R=async()=>{try{const n={barangays:r.value.barangay,indicator:r.value.indicator.id},a=await S.post("/api/indicator/count",n);f.value.push(a.data)}catch(n){console.log(n)}y.value=!1},$=n=>{let a="";return a+="Code,Description,"+n.barangays.join(",")+`,Total\r
`,n.content.forEach(d=>{const o=d.count.reduce((i,g)=>i+g,0),C=[d.code,d.description,...d.count,o].join(",");a+=C+`\r
`}),a},D=(n,a)=>{const d=new Blob([n],{type:"text/csv;charset=utf-8;"}),o=document.createElement("a");o.href=URL.createObjectURL(d),o.setAttribute("download",a),document.body.appendChild(o),o.click(),document.body.removeChild(o)},I=n=>{const a=$(n);D(a,"export.csv")},B=JSON.parse(localStorage.getItem("userData")),L=async()=>{try{const n=await S.get("/api/barangays");m.value=n.data.map(a=>a.barangay)}catch(n){console.error("Error fetching data:",n)}};return U(()=>{B.role==="admin"?L():m.value=[B.barangay],E()}),(n,a)=>{const d=F("VCardAction");return c(),u("div",null,[e(k,{class:"mb-5"},{default:l(()=>[e(V,{class:"mt-2 ms-1"},{default:l(()=>[v(" Generate Reports on the counts of a certain Indicators ")]),_:1}),e(x,null,{default:l(()=>[v(" This module allows you to generate a report that display the count of a certain indicator in selected barangay/s. For Example, you want to generate the count of Sex in Alitao, just select the barangay (can be multiple select) and the indicators you want. Also, you can generate as many reports as you want on. The reports will appear below. Each report can be downloaded in CSV format. ")]),_:1})]),_:1}),e(k,null,{default:l(()=>[e(V,{class:"d-flex justify-space-between align-center",onClick:a[0]||(a[0]=o=>y.value=!t(y)),style:{cursor:"pointer"}},{default:l(()=>[H,e(b,{icon:t(y)?"mdi-chevron-up":"mdi-chevron-down",variant:"text"},null,8,["icon"])]),_:1}),e(G,null,{default:l(()=>[J(s("div",null,[s("div",K,[e(x,null,{default:l(()=>[e(M,null,{default:l(()=>[e(j,{cols:"12",md:"6"},{default:l(()=>[e(A,{label:"Select Barangay",items:t(m),modelValue:t(r).barangay,"onUpdate:modelValue":a[1]||(a[1]=o=>t(r).barangay=o),multiple:"",chips:"",clearable:""},null,8,["items","modelValue"])]),_:1}),e(j,{cols:"12",md:"6"},{default:l(()=>[e(A,{label:"Select Indicator",items:t(T),"item-title":"lookup_name","item-value":"id",modelValue:t(r).indicator,"onUpdate:modelValue":a[2]||(a[2]=o=>t(r).indicator=o),clearable:""},null,8,["items","modelValue"])]),_:1})]),_:1})]),_:1}),e(d,{class:"ms-auto"},{default:l(()=>[s("div",P,[e(b,{class:"ma-2",variant:"outlined",onClick:a[3]||(a[3]=()=>{t(r).barangay.length!==t(m).length?t(r).barangay=t(m):t(r).barangay=[]})},{default:l(()=>[v(p(t(r).barangay.length!==t(m).length?"Select":"Deselect")+" All Brgy ",1)]),_:1}),e(b,{class:"ma-2",variant:"outlined",disabled:!(t(f).length>0),onClick:a[4]||(a[4]=o=>f.value=[])},{default:l(()=>[v(" Reset ")]),_:1},8,["disabled"]),e(b,{class:"ma-2",onClick:R,disabled:!(t(r).barangay&&t(r).indicator)},{default:l(()=>[v(" Add Report ")]),_:1},8,["disabled"])])]),_:1})])],512),[[q,t(y)]])]),_:1})]),_:1}),(c(!0),u(_,null,w(t(f),(o,C)=>(c(),Y(k,{class:"mt-5"},{default:l(()=>[e(V,{class:"d-flex justify-space-between align-center pt-3"},{default:l(()=>[s("div",Q,[s("h6",W," Count of "+p(o.indicator)+" for Brgy/s "+p(o.barangays.join(", ")),1)]),s("div",null,[e(b,{onClick:i=>I(o),icon:"mdi-download",variant:"text"},null,8,["onClick"]),e(b,{icon:"mdi-trash-can-outline",variant:"text",onClick:i=>t(f).splice(C,1)},null,8,["onClick"])])]),_:2},1024),e(x,null,{default:l(()=>[X,e(z,null,{default:l(()=>[s("thead",null,[s("tr",null,[Z,(c(!0),u(_,null,w(o.barangays,i=>(c(),u("th",null,p(i),1))),256)),aa])]),s("tbody",null,[(c(!0),u(_,null,w(o.content,i=>(c(),u("tr",null,[s("td",null,[s("b",null,"["+p(i.code)+"] "+p(i.description),1)]),(c(!0),u(_,null,w(i.count,g=>(c(),u("td",null,p(g),1))),256)),s("td",null,[s("b",null,p(i.count.reduce((g,N)=>g+N,0)),1)])]))),256))])]),_:2},1024)]),_:2},1024)]),_:2},1024))),256))])}}});export{la as default};
