import{_ as K}from"./AppDateTimePicker.vue_vue_type_style_index_0_lang-c0c4cc5e.js";import{_ as O}from"./SnackBar.vue_vue_type_script_setup_true_lang-1315b352.js";import{d as Q,l as i,aG as W,r as j,o as d,c as m,q as e,w as t,a1 as B,Y as c,a6 as D,$ as I,s as a,a7 as h,aJ as X,b as L,n as r,aK as y,ae as v,af as f,aH as N,U as G,F as x,a as w,aL as Z,y as p,V as ee,P as Y,aM as te,aa as U}from"./main-27bf03b5.js";import{V as E}from"./VCombobox-2660c3a9.js";import"./VSnackbar-45528893.js";import"./filter-85954aca.js";const ae=r("h6",{class:"text-h6"}," Filter ",-1),le={class:"gap-x-2 mt-2"},oe={class:"d-flex justify-end"},ne={class:"text-h6"},se=r("th",null," Age Range ",-1),ge=Q({__name:"custom",setup(re){const g=i(!0),C=i([]),T=i(null),_=i(),V=i(),b=i(),s=i({barangay:"",dateFrom:new Date(new Date().setFullYear(new Date().getFullYear()-1)),dateTo:new Date,selectedLookup:[],selectedIndicators:[],ageRange:[{from:0,to:5},{from:6,to:10},{from:11,to:15},{from:16,to:20},{from:21,to:25},{from:26,to:30},{from:31,to:35},{from:36,to:40}]}),A=i([]),S=i([]),z=async()=>{try{const o=await U.get("/api/lookup");A.value=o.data}catch(o){console.error("Error fetching data:",o)}},J=o=>{s.value.selectedLookup=o,S.value=o.lookup_list,s.value.selectedIndicators=[],b.value=void 0},P=async()=>{try{const o=await U.get("/api/report/custom",{params:s.value});console.log(o.data),b.value=o.data,g.value=!1,T.value.show("success","Generate Finished")}catch(o){T.value.show("error","Please contact you administrator"),console.log(o)}},M=o=>{let l="data:text/csv;charset=utf-8,";return l+="Age Range,"+o[0].result.map(u=>u.indicator).join(",")+`\r
`,o.forEach(u=>{const k=[u.ageRange];u.result.forEach(F=>{k.push(F.count)}),l+=k.join(",")+`\r
`}),l},q=()=>{const o=M(b.value),l=encodeURI(o),u=document.createElement("a");u.setAttribute("href",l),u.setAttribute("download","custom_report.csv"),document.body.appendChild(u),u.click()},$=JSON.parse(localStorage.getItem("userData")),H=async()=>{try{const o=await U.get("/api/barangays");C.value=o.data.map(l=>l.barangay)}catch(o){console.error("Error fetching data:",o)}};return W(()=>{$.role==="admin"?H():C.value=[$.barangay],z()}),(o,l)=>{const u=K,k=j("VText"),F=j("Button");return d(),m("div",null,[e(I,null,{default:t(()=>[e(B,{class:"mt-2 ms-1"},{default:t(()=>[c(" Generate Customized Reports ")]),_:1}),e(D,null,{default:t(()=>[c(" This module allows you to generate a customized list reports where you can select columns or details you want to include. Just select the columns that you want to be included. Then perform some filtering if needed. You will be given a table of the generated data where you can also export as CSV file. ")]),_:1})]),_:1}),e(I,{class:"mt-5"},{default:t(()=>[e(B,{class:"d-flex justify-space-between align-center",onClick:l[0]||(l[0]=n=>g.value=!a(g))},{default:t(()=>[ae,e(h,{variant:"text",icon:a(g)?"mdi-chevron-up":"mdi-chevron-down"},null,8,["icon"])]),_:1}),e(X,null,{default:t(()=>[a(g)?(d(),L(D,{key:0,class:"d-flex flex-column gap-y-3"},{default:t(()=>[r("div",null,[e(y,{class:"mb-3"},{default:t(()=>[c(" Select Barangay ")]),_:1}),e(v,null,{default:t(()=>[e(f,null,{default:t(()=>[e(E,{modelValue:a(s).barangay,"onUpdate:modelValue":l[1]||(l[1]=n=>a(s).barangay=n),items:a(C),clearable:""},null,8,["modelValue","items"])]),_:1})]),_:1})]),r("div",null,[e(y,{class:"mb-3"},{default:t(()=>[c(" Date Range: ")]),_:1}),e(v,null,{default:t(()=>[e(f,{cols:"12",md:"6"},{default:t(()=>[e(u,{label:"Date From",modelValue:a(s).dateFrom,"onUpdate:modelValue":l[2]||(l[2]=n=>a(s).dateFrom=n)},null,8,["modelValue"])]),_:1}),e(f,{cols:"12",md:"6"},{default:t(()=>[e(u,{modelValue:a(s).dateTo,"onUpdate:modelValue":l[3]||(l[3]=n=>a(s).dateTo=n),label:"Date To"},null,8,["modelValue"])]),_:1})]),_:1})]),r("div",null,[e(v,null,{default:t(()=>[e(f,{cols:"12",md:"6"},{default:t(()=>[e(y,{class:"mb-3"},{default:t(()=>[c(" Select Lookup ")]),_:1}),e(v,null,{default:t(()=>[e(f,null,{default:t(()=>[e(E,{items:a(A),"item-title":"lookup_name","onUpdate:modelValue":J},null,8,["items"])]),_:1})]),_:1})]),_:1}),e(f,null,{default:t(()=>[e(y,{class:"mb-3"},{default:t(()=>[c(" Select Indicators ")]),_:1}),e(E,{modelValue:a(s).selectedIndicators,"onUpdate:modelValue":l[4]||(l[4]=n=>a(s).selectedIndicators=n),items:a(S),"item-title":"description","item-value":"lookup_key",disabled:!(a(S).length>0),multiple:"",chips:"",clearable:""},null,8,["modelValue","items","disabled"])]),_:1})]),_:1})]),r("div",null,[e(y,{class:"mb-3"},{default:t(()=>[c(" Select Age: ")]),_:1}),e(v,null,{default:t(()=>[e(f,null,{default:t(()=>[e(N,{label:"From",modelValue:a(_),"onUpdate:modelValue":l[5]||(l[5]=n=>G(_)?_.value=n:null),type:"number"},null,8,["modelValue"])]),_:1}),e(f,{class:"d-flex flex-row align-center gap-x-4"},{default:t(()=>[e(N,{label:"To",modelValue:a(V),"onUpdate:modelValue":l[6]||(l[6]=n=>G(V)?V.value=n:null),type:"number"},null,8,["modelValue"]),e(h,{icon:"mdi-plus",onClick:l[7]||(l[7]=n=>o.addAndSortByFrom(a(_),a(V))),disabled:!(a(_)>0&&a(V)>0)},null,8,["disabled"])]),_:1})]),_:1}),r("div",le,[(d(!0),m(x,null,w(a(s).ageRange,(n,R)=>(d(),L(Z,{color:"primary",class:"mx-1 mt-2"},{default:t(()=>[e(k,null,{default:t(()=>[c(p(n.from)+" - "+p(n.to),1)]),_:2},1024),e(F,{class:"d-flex align-center ms-1",onClick:ue=>o.removeElementArray(R)},{default:t(()=>[e(ee,{icon:"mdi-close",style:{"font-size":"0.9rem !important"}})]),_:2},1032,["onClick"])]),_:2},1024))),256))])]),r("div",oe,[e(h,{disabled:!(a(s).barangay&&a(s).selectedIndicators.length>0),onClick:P},{default:t(()=>[c(" Generate ")]),_:1},8,["disabled"])])]),_:1})):Y("",!0)]),_:1})]),_:1}),a(b)?(d(),L(I,{key:0,class:"mt-5"},{default:t(()=>[e(B,{class:"d-flex justify-space-between mt-2 mx-1 align-center"},{default:t(()=>[r("h6",ne,p(a(s).selectedLookup.lookup_name),1),e(h,{variant:"outlined",onClick:q},{default:t(()=>[c(" Export ")]),_:1})]),_:1}),e(D,null,{default:t(()=>[e(te,null,{default:t(()=>[r("thead",null,[r("tr",null,[se,(d(!0),m(x,null,w(a(s).selectedIndicators,n=>(d(),m("th",{key:n},p(n.description),1))),128))])]),r("tbody",null,[(d(!0),m(x,null,w(a(b),n=>(d(),m("tr",null,[r("td",null,p(n.ageRange),1),(d(!0),m(x,null,w(n.result,R=>(d(),m("td",null,p(R.count),1))),256))]))),256))])]),_:1})]),_:1})]),_:1})):Y("",!0),e(O,{ref_key:"SnackBarRef",ref:T},null,512)])}}});export{ge as default};
