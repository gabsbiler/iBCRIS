import{d as X,o as p,b as $,w as e,p as a,U as j,$ as D,a0 as h,m as r,x as d,R as n,A as Z,j as ee,k as m,as as ae,r as N,c as v,q as o,ac as te,Y as oe,O as k,Q as q,V as Q,F as L,a as se}from"./main-cf6206e3.js";import{V as le}from"./VDialog-68c23def.js";import{a as C}from"./axios-60a05fd8.js";import{a as ne}from"./avatar-1-3f757947.js";import{V as E,a as B}from"./VRow-0d54e54c.js";import{V as ie}from"./VTextField-5b43ac53.js";import{V as re}from"./VDataTable-42dd9b23.js";import{V as T}from"./VChip-78e581ef.js";import{V as ce}from"./VSnackbar-1fa9152e.js";import"./VOverlay-a275844d.js";import"./forwardRefs-9d31fcaa.js";import"./VDivider-1ce2e50d.js";import"./axios-4a70c6fc.js";import"./VCounter-d8f7e966.js";import"./VCheckboxBtn-8f56e1d5.js";import"./VSelect-e2ced024.js";import"./VList-f8042727.js";import"./ssrBoot-d4edb8ce.js";import"./VMenu-f3279b4c.js";import"./VTable-add566b6.js";const de=r("span",{class:"text-5xl"},"!",-1),ue={class:"text-lg font-weight-medium"},me=X({__name:"ConfirmDialog",props:{confirmationQuestion:{},isDialogVisible:{type:Boolean},confirmTitle:{},confirmMsg:{},cancelTitle:{},cancelMsg:{}},emits:["update:isDialogVisible","confirm","cancel"],setup(A,{emit:c}){const S=A,i=x=>{c("update:isDialogVisible",x)},y=()=>{c("confirm",!0),c("cancel",!0),c("update:isDialogVisible",!1)},b=()=>{c("cancel",!0),c("update:isDialogVisible",!1)};return(x,V)=>(p(),$(le,{"max-width":"500","model-value":S.isDialogVisible,"onUpdate:modelValue":i},{default:e(()=>[a(j,{class:"text-center px-10 py-6"},{default:e(()=>[a(D,null,{default:e(()=>[a(h,{icon:"",variant:"outlined",color:"warning",class:"my-4",style:{"block-size":"88px","inline-size":"88px","pointer-events":"none"}},{default:e(()=>[de]),_:1}),r("h6",ue,d(S.confirmationQuestion),1)]),_:1}),a(D,{class:"d-flex align-center justify-center gap-2"},{default:e(()=>[a(h,{variant:"elevated",onClick:y},{default:e(()=>[n(" Confirm ")]),_:1}),a(h,{color:"secondary",variant:"tonal",onClick:b},{default:e(()=>[n(" Cancel ")]),_:1})]),_:1})]),_:1})]),_:1},8,["model-value"]))}}),pe="/build/assets/background-1-ceba94e3.jpg";const fe={class:"d-flex h-0"},ge={class:"user-profile-info w-100 mt-16 pt-6 pt-sm-0 mt-sm-0"},_e={class:"d-flex align-center justify-center justify-sm-space-between flex-wrap gap-4"},he={class:"d-flex flex-wrap justify-center justify-sm-start flex-grow-1 gap-5"},ye={class:"d-flex align-center"},be={class:"d-flex align-center"},xe={class:"d-flex align-center"},ve={class:"d-flex align-center"},Ve={class:"d-flex px-auto gap-1"},we={key:0},ke={key:1},Ce={key:2},Pe={__name:"[id]",setup(A){const c=Z(),S=ee(),i=m();m(97);const y=m(),b=m([]),x=m(!1),V=m(!1),M=m(null),w=m(!1),I=m(),R=m(),z=s=>{I.value=s.message,R.value=s.type,w.value=!0};async function F(){try{const s=c.params.id,l=await C.get("/api/household-list",{params:{id:c.query.household_id}});i.value=l.data}catch(s){console.log(s)}}async function Y(){try{const s=await C.get("/api/lookup/");b.value=s.data}catch(s){console.error("Error fetching lookups:",s)}}async function P(){try{const s=await C.post("/api/addMember",{household_id:c.query.household_id});S.push("/household/member/demographics?member_id="+s.data.household_member_id+"&household_id="+c.query.household_id)}catch(s){console.log(s)}}const O=async()=>{try{await C.delete("/api/household/member",{data:{household_member_id:M.value}}),z({message:"Household member successfully deleted",type:"success"}),F()}catch(s){z({message:s.response.data.message,type:"warning"})}M.value=null,V.value=!1},G=s=>{M.value=s,V.value=!0},J=[{title:"Full Name",key:"demographic.lastname"},{title:"Relationship",key:"demographic.relationship"},{title:"Sex",key:"demographic.sex"},{title:"Age",key:"demographic.age"},{title:"Status",key:"demographic.tags"},{title:"Action",key:"actions"}];ae(()=>{F(),Y()});const K=async(s,l)=>{try{const f=await C.put("/api/household/survey-status",{household_id:s,surveyStatus:!l});console.log(f.data.message,l),i.value.surveyStatus=!l}catch(f){console.error("Error updating survey status:",f)}};return(s,l)=>{const f=N("VText"),H=me,U=N("IconBtn"),W=N("RouterLink");return p(),v(L,null,[o(i)&&o(b)?(p(),$(j,{key:0},{default:e(()=>[a(te,{src:o(pe),"min-height":"125","max-height":"175",cover:""},null,8,["src"]),a(D,{class:"d-flex align-bottom flex-sm-row flex-column justify-center gap-x-4",style:{"min-height":"125px"}},{default:e(()=>[r("div",fe,[a(oe,{rounded:"",size:"125",image:o(ne),class:"user-profile-avatar mx-auto"},null,8,["image"])]),r("div",ge,[r("div",_e,[a(E,null,{default:e(()=>[a(B,{cols:"12",sm:"9"},{default:e(()=>[r("div",he,[r("span",ye,[a(f,null,{default:e(()=>[n("Brgy (Purok/Sitio):"),r("b",null,d(o(i).Barangay),1)]),_:1})]),r("span",be,[a(f,null,{default:e(()=>[n("BSN:"),r("b",null,d(o(i).BSN),1)]),_:1})]),r("span",xe,[a(f,null,{default:e(()=>[n("HUSN:"),r("b",null,d(o(i).HUSN),1)]),_:1})]),r("span",ve,[a(f,null,{default:e(()=>[n("HSN:"),r("b",null,d(o(i).HSN),1)]),_:1})])])]),_:1}),a(B,{class:"d-flex",cols:"12",sm:"3"},{default:e(()=>[a(h,{class:"mx-auto",onClick:l[0]||(l[0]=()=>{K(o(i).id,o(i).surveyStatus)}),color:o(i).surveyStatus?"success":"warning"},{default:e(()=>[n(d(o(i).surveyStatus?"Completed":"Mark as Complete"),1)]),_:1},8,["color"])]),_:1})]),_:1})])])]),_:1})]),_:1})):k("",!0),o(i)?(p(),$(j,{key:1,class:"mt-3"},{default:e(()=>[a(D,null,{default:e(()=>[a(E,null,{default:e(()=>[a(B,{class:"d-flex gap-x-3"},{default:e(()=>[a(h,{color:"primary",onClick:l[1]||(l[1]=t=>x.value=!0)},{default:e(()=>[n(" Add Member ")]),_:1})]),_:1}),a(B,{"offset-md":"4"},{default:e(()=>[a(ie,{modelValue:o(y),"onUpdate:modelValue":l[2]||(l[2]=t=>q(y)?y.value=t:null),density:"compact",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":"",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),a(H,{isDialogVisible:o(x),confirmationQuestion:"Add another member?",onConfirm:P,onCancel:l[3]||(l[3]=t=>x.value=!1)},null,8,["isDialogVisible"]),a(h,{class:"me-3 my-3 d-md-none",color:"primary",icon:"mdi-plus"})]),_:1})]),_:1}),a(D,null,{default:e(()=>[a(o(re),{headers:J,items:o(i).household_members,search:o(y)},{"item.actions":e(({item:t})=>[r("div",Ve,[a(U,{onClick:u=>G(t.raw.id)},{default:e(()=>[a(Q,{icon:"mdi-delete-outline"})]),_:2},1032,["onClick"]),a(U,null,{default:e(()=>[a(W,{to:{name:"household-member-tab",params:{tab:"demographics"},query:{member_id:t.raw.id,household_id:t.raw.household_id}}},{default:e(()=>[a(Q,{icon:`
                mdi-information-slab-circle-outline`})]),_:2},1032,["to"])]),_:2},1024)])]),"item.demographic.lastname":e(({item:t})=>[n(d(t.raw.demographic.lastname+", "+t.raw.demographic.firstname+" "+t.raw.demographic.middlename)+" ",1)]),"item.demographic.relationship":e(({item:t})=>{var u,g;return[n(d(((g=(u=o(b).filter(_=>_.column_number==="3")[0])==null?void 0:u.lookup_list.filter(_=>_.lookup_key===t.raw.demographic._3)[0])==null?void 0:g.description)||"Not Specified"),1)]}),"item.demographic.sex":e(({item:t})=>{var u,g;return[n(d(((g=(u=o(b).filter(_=>_.column_number==="5")[0])==null?void 0:u.lookup_list.filter(_=>_.lookup_key===t.raw.demographic._5)[0])==null?void 0:g.description)||"Not Specified"),1)]}),"item.demographic.age":e(({item:t})=>[n(d(new Date().getFullYear()-new Date(t.raw.demographic._6).getFullYear()-(new Date().getMonth()<new Date(t.raw.demographic._6).getMonth()||new Date().getMonth()===new Date(t.raw.demographic._6).getMonth()&&new Date().getDate()<new Date(t.raw.demographic._6).getDate()?1:0)),1)]),"item.demographic.tags":e(({item:t})=>[(p(!0),v(L,null,se(t.raw.demographic.tags.split(","),(u,g)=>(p(),v("span",{key:g},[u.trim()=="alive"?(p(),v("span",we,[a(T,{color:"success",class:"font-weight-medium",size:"small"},{default:e(()=>[n(" Alive ")]),_:1})])):k("",!0),u.trim()=="teenage_pregnancy"?(p(),v("span",ke,[a(T,{color:"gray",class:"font-weight-medium",size:"small"},{default:e(()=>[n(" Teenage Pregnancy ")]),_:1})])):k("",!0),u.trim()=="dead"?(p(),v("span",Ce,[a(T,{color:"error",class:"font-weight-medium",size:"small"},{default:e(()=>[n(" Dead ")]),_:1})])):k("",!0)]))),128))]),_:1},8,["items","search"])]),_:1}),a(H,{isDialogVisible:o(V),confirmationQuestion:"This will be deleted permanently. Are you sure?",onConfirm:O,onCancel:l[4]||(l[4]=t=>V.value=!1)},null,8,["isDialogVisible"]),a(ce,{modelValue:o(w),"onUpdate:modelValue":l[6]||(l[6]=t=>q(w)?w.value=t:null),location:"top center",variant:"flat",color:o(R)},{actions:e(()=>[a(h,{color:"white",onClick:l[5]||(l[5]=t=>w.value=!1)},{default:e(()=>[n(" Close ")]),_:1})]),default:e(()=>[n(d(o(I))+" ",1)]),_:1},8,["modelValue","color"])]),_:1})):k("",!0)],64)}}};export{Pe as default};
