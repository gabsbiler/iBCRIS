import{_ as ye}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-b64333c5.js";import{a as U}from"./axios-60a05fd8.js";import{a7 as xe,b3 as Ve,a9 as be,S as ee,k as d,as as ce,B as G,b4 as we,ab as ke,ax as Se,p as e,G as te,F as K,D as ie,a_ as Ce,b5 as De,aA as ae,aB as Be,aX as Ne,aS as He,d as me,A as fe,o as C,c as M,w as a,R as m,a0 as A,q as o,b as se,U as ne,$ as O,av as Fe,O as $,Q,j as Ie,r as le,ac as Ue,m as h,Y as Re,x as S,V as re,a as Me}from"./main-ee999be4.js";import{V as Y,a as x}from"./VRow-b84d81cd.js";import{m as Pe,c as Ae,u as Te,a as de,f as $e,d as Ee,e as ze,V as P}from"./VTextField-5e129094.js";import{f as je}from"./forwardRefs-9d31fcaa.js";import{V as qe}from"./VDialog-63c4d24e.js";import{a as Ge}from"./avatar-1-3f757947.js";import{V as Le,a as oe}from"./VSelect-4a1635ff.js";import{V as Ke}from"./VDataTable-c9cda628.js";import{V as Oe}from"./VSnackbar-9d2e1910.js";import"./axios-4a70c6fc.js";import"./VOverlay-d1ced1dc.js";import"./VDivider-81cb78e4.js";import"./VList-24266b93.js";import"./ssrBoot-16871ecf.js";import"./VMenu-0cb1867b.js";import"./VCheckboxBtn-178c9cd1.js";import"./VTable-7cca798b.js";const Qe=xe()({name:"VTextarea",directives:{Intersect:Ve},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:t=>!isNaN(parseFloat(t))},maxRows:{type:[Number,String],validator:t=>!isNaN(parseFloat(t))},suffix:String,modelModifiers:Object,...Pe(),...Ae()},emits:{"click:control":t=>!0,"mousedown:control":t=>!0,"update:focused":t=>!0,"update:modelValue":t=>!0},setup(t,D){let{attrs:b,emit:s,slots:g}=D;const f=be(t,"modelValue"),{isFocused:_,focus:N,blur:w}=Te(t),i=ee(()=>typeof t.counterValue=="function"?t.counterValue(f.value):(f.value||"").toString().length),r=ee(()=>{if(b.maxlength)return b.maxlength;if(!(!t.counter||typeof t.counter!="number"&&typeof t.counter!="string"))return t.counter});function E(l,c){var v,V;!t.autofocus||!l||(V=(v=c[0].target)==null?void 0:v.focus)==null||V.call(v)}const H=d(),R=d(),z=d(""),B=d(),L=ee(()=>_.value||t.persistentPlaceholder);function j(){var l;B.value!==document.activeElement&&((l=B.value)==null||l.focus()),_.value||N()}function X(l){j(),s("click:control",l)}function J(l){s("mousedown:control",l)}function W(l){l.stopPropagation(),j(),ae(()=>{f.value="",Be(t["onClick:clear"],l)})}function Z(l){var v;const c=l.target;if(f.value=c.value,(v=t.modelModifiers)!=null&&v.trim){const V=[c.selectionStart,c.selectionEnd];ae(()=>{c.selectionStart=V[0],c.selectionEnd=V[1]})}}const F=d();function I(){t.autoGrow&&ae(()=>{if(!F.value||!R.value)return;const l=getComputedStyle(F.value),c=getComputedStyle(R.value.$el),v=parseFloat(l.getPropertyValue("--v-field-padding-top"))+parseFloat(l.getPropertyValue("--v-input-padding-top"))+parseFloat(l.getPropertyValue("--v-field-padding-bottom")),V=F.value.scrollHeight,T=parseFloat(l.lineHeight),q=Math.max(parseFloat(t.rows)*T+v,parseFloat(c.getPropertyValue("--v-input-control-height"))),u=parseFloat(t.maxRows)*T+v||1/0;z.value=Ne(He(V??0,q,u))})}ce(I),G(f,I),G(()=>t.rows,I),G(()=>t.maxRows,I),G(()=>t.density,I);let n;return G(F,l=>{l?(n=new ResizeObserver(I),n.observe(F.value)):n==null||n.disconnect()}),we(()=>{n==null||n.disconnect()}),ke(()=>{const l=!!(g.counter||t.counter||t.counterValue),c=!!(l||g.details),[v,V]=Se(b),[{modelValue:T,...q}]=de.filterProps(t),[u]=$e(t);return e(de,te({ref:H,modelValue:f.value,"onUpdate:modelValue":p=>f.value=p,class:["v-textarea v-text-field",{"v-textarea--prefixed":t.prefix,"v-textarea--suffixed":t.suffix,"v-text-field--prefixed":t.prefix,"v-text-field--suffixed":t.suffix,"v-textarea--auto-grow":t.autoGrow,"v-textarea--no-resize":t.noResize||t.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(t.variant)},t.class],style:t.style},v,q,{focused:_.value}),{...g,default:p=>{let{isDisabled:y,isDirty:k,isReadonly:pe,isValid:ge}=p;return e(Ee,te({ref:R,style:{"--v-textarea-control-height":z.value},onClick:X,onMousedown:J,"onClick:clear":W,"onClick:prependInner":t["onClick:prependInner"],"onClick:appendInner":t["onClick:appendInner"],role:"textbox"},u,{active:L.value||k.value,dirty:k.value||t.dirty,disabled:y.value,focused:_.value,error:ge.value===!1}),{...g,default:ve=>{let{props:{class:ue,...he}}=ve;return e(K,null,[t.prefix&&e("span",{class:"v-text-field__prefix"},[t.prefix]),ie(e("textarea",te({ref:B,class:ue,value:f.value,onInput:Z,autofocus:t.autofocus,readonly:pe.value,disabled:y.value,placeholder:t.placeholder,rows:t.rows,name:t.name,onFocus:j,onBlur:w},he,V),null),[[Ce("intersect"),{handler:E},null,{once:!0}]]),t.autoGrow&&ie(e("textarea",{class:[ue,"v-textarea__sizer"],"onUpdate:modelValue":_e=>f.value=_e,ref:F,readonly:!0,"aria-hidden":"true"},null),[[De,f.value]]),t.suffix&&e("span",{class:"v-text-field__suffix"},[t.suffix])])}})},details:c?p=>{var y;return e(K,null,[(y=g.details)==null?void 0:y.call(g,p),l&&e(K,null,[e("span",null,null),e(ze,{active:t.persistentCounter||_.value,value:i.value,max:r.value},g.counter)])])}:void 0})}),je({},H,R,B)}}),Ye=me({__name:"EditHouseholdDialog",props:["householdData"],setup(t){const D=t,b=d(!1),s=d(),g=d(!1),f=fe(),_=()=>{b.value=!0,s.value={...D.householdData},console.log(s.value.HouseholdKey)},N=async()=>{g.value=!0;try{const w=await U.put(`/api/household/${f.query.household_id}`,{barangay:s.value.Barangay,sitio:s.value.sitio,husn:s.value.HUSN,bsn:s.value.BSN,hsn:s.value.HSN,address:s.value.address});console.log(w)}catch(w){console.error(w)}g.value=!1};return(w,i)=>(C(),M("div",null,[e(A,{onClick:_,block:""},{default:a(()=>[m("Edit")]),_:1}),e(qe,{modelValue:o(b),"onUpdate:modelValue":i[8]||(i[8]=r=>Q(b)?b.value=r:null),"max-width":"800"},{default:a(()=>[o(s)?(C(),se(ne,{key:0,title:"Edit Household"},{default:a(()=>[e(O,null,{default:a(()=>[e(Y,null,{default:a(()=>[e(x,{cols:"12"},{default:a(()=>[e(P,{label:"Household Key",disabled:"",modelValue:o(s).HouseholdKey,"onUpdate:modelValue":i[0]||(i[0]=r=>o(s).HouseholdKey=r)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"4"},{default:a(()=>[e(P,{label:"HSN",modelValue:o(s).HSN,"onUpdate:modelValue":i[1]||(i[1]=r=>o(s).HSN=r)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"4"},{default:a(()=>[e(P,{label:"BSN",modelValue:o(s).BSN,"onUpdate:modelValue":i[2]||(i[2]=r=>o(s).BSN=r)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"4"},{default:a(()=>[e(P,{label:"HUSN",modelValue:o(s).HUSN,"onUpdate:modelValue":i[3]||(i[3]=r=>o(s).HUSN=r)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"4"},{default:a(()=>[e(P,{label:"Baranggay",modelValue:o(s).Barangay,"onUpdate:modelValue":i[4]||(i[4]=r=>o(s).Barangay=r)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"4"},{default:a(()=>[e(P,{label:"Sitio",modelValue:o(s).sitio,"onUpdate:modelValue":i[5]||(i[5]=r=>o(s).sitio=r)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12"},{default:a(()=>[e(Qe,{label:"Address",modelValue:o(s).address,"onUpdate:modelValue":i[6]||(i[6]=r=>o(s).address=r)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Fe,{class:"d-flex justify-end"},{default:a(()=>[e(A,{onClick:i[7]||(i[7]=r=>b.value=!1)},{default:a(()=>[m(" Cancel ")]),_:1}),e(A,{variant:"elevated",onClick:N,loading:o(g)},{default:a(()=>[m(" Save ")]),_:1},8,["loading"])]),_:1})]),_:1})):$("",!0)]),_:1},8,["modelValue"])]))}}),Xe="/build/assets/background-1-ceba94e3.jpg",Je={class:"d-flex h-0"},We={class:"user-profile-info w-100 mt-16 pt-6 pt-sm-0 mt-sm-0"},Ze={class:"d-flex align-center justify-center justify-sm-space-between flex-wrap gap-4"},et={class:"d-flex flex-wrap justify-center justify-sm-start flex-grow-1 gap-5"},tt={class:"d-flex align-center"},at={class:"d-flex align-center"},lt={class:"d-flex align-center"},ot={class:"d-flex align-center"},st=h("div",{class:"d-flex gap-x-3"},null,-1),nt={class:"d-flex px-auto gap-1"},ut={key:0},it={key:1},rt={key:2},Nt=me({__name:"[id]",setup(t){const D=fe(),b=Ie(),s=d(),g=d();d(97);const f=d(),_=d(),N=d([]),w=d(!1),i=d(!1),r=d(!1),E=d(null),H=d(!1),R=d(),z=d(),B=n=>{R.value=n.message,z.value=n.type,H.value=!0};async function L(){try{const n=D.params.id,l=await U.get("/api/household-list",{params:{id:D.query.household_id}});s.value=l.data,_.value=s.value.household_container.id}catch(n){console.log(n)}try{const n=await U.get("/api/container");g.value=n.data}catch(n){console.error(n)}}async function j(){try{const n=await U.get("/api/lookup/");N.value=n.data}catch(n){console.error("Error fetching lookups:",n)}}const X=async()=>{w.value=!0;try{const n=await U.put(`/api/household/${D.query.household_id}/update-container`,{container_id:_.value});B({message:n.data.message,type:"success"}),w.value=!1}catch(n){B({message:n,type:"error"}),w.value=!1}};async function J(){try{const n=await U.post("/api/addMember",{household_id:D.query.household_id});b.push("/household/member/demographics?member_id="+n.data.household_member_id+"&household_id="+D.query.household_id)}catch(n){console.log(n)}}const W=async()=>{try{await U.delete("/api/household/member",{data:{household_member_id:E.value}}),B({message:"Household member successfully deleted",type:"success"}),L()}catch(n){B({message:n.response.data.message,type:"warning"})}E.value=null,r.value=!1},Z=n=>{E.value=n,r.value=!0},F=[{title:"Full Name",key:"demographic.lastname"},{title:"Relationship",key:"demographic.relationship"},{title:"Sex",key:"demographic.sex"},{title:"Age",key:"demographic.age"},{title:"Status",key:"demographic.tags"},{title:"Action",key:"actions"}];ce(()=>{L(),j()});const I=async(n,l)=>{try{const c=await U.put("/api/household/survey-status",{household_id:n,surveyStatus:!l});console.log(c.data.message,l),s.value.surveyStatus=!l}catch(c){console.error("Error updating survey status:",c)}};return(n,l)=>{const c=le("VText"),v=Ye,V=ye,T=le("IconBtn"),q=le("RouterLink");return C(),M("section",null,[o(s)&&o(N)?(C(),se(ne,{key:0},{default:a(()=>[e(Ue,{src:o(Xe),"min-height":"125","max-height":"175",cover:""},null,8,["src"]),e(O,{class:"d-flex align-bottom flex-sm-row flex-column justify-center gap-x-4",style:{"min-height":"125px"}},{default:a(()=>[h("div",Je,[e(Re,{rounded:"",size:"125",image:o(Ge),class:"user-profile-avatar mx-auto"},null,8,["image"])]),h("div",We,[h("div",Ze,[e(Y,null,{default:a(()=>[e(x,{cols:"12",sm:"8",class:"d-flex flex-column gap-y-3"},{default:a(()=>[h("div",et,[h("span",tt,[e(c,null,{default:a(()=>[m("Brgy (Purok/Sitio):"),h("b",null,S(o(s).Barangay),1)]),_:1})]),h("span",at,[e(c,null,{default:a(()=>[m("BSN:"),h("b",null,S(o(s).BSN),1)]),_:1})]),h("span",lt,[e(c,null,{default:a(()=>[m("HUSN:"),h("b",null,S(o(s).HUSN),1)]),_:1})]),h("span",ot,[e(c,null,{default:a(()=>[m("HSN:"),h("b",null,S(o(s).HSN),1)]),_:1})])]),st]),_:1}),e(x,{class:"d-flex flex-column gap-y-2",cols:"12",sm:"4"},{default:a(()=>[e(Y,null,{default:a(()=>[e(x,null,{default:a(()=>[e(Le,{modelValue:o(_),"onUpdate:modelValue":[l[0]||(l[0]=u=>Q(_)?_.value=u:null),X],items:o(g),"item-title":"name","item-value":"id",density:"compact",label:"Folder",loading:o(w)},null,8,["modelValue","items","loading"])]),_:1}),e(x,null,{default:a(()=>[e(v,{"household-data":o(s)},null,8,["household-data"])]),_:1})]),_:1}),e(A,{onClick:l[1]||(l[1]=()=>{I(o(s).id,o(s).surveyStatus)}),color:o(s).surveyStatus?"success":"warning"},{default:a(()=>[m(S(o(s).surveyStatus?"Completed":"Mark as Complete"),1)]),_:1},8,["color"])]),_:1})]),_:1})])])]),_:1})]),_:1})):$("",!0),o(s)?(C(),se(ne,{key:1,class:"mt-3"},{default:a(()=>[e(O,null,{default:a(()=>[e(Y,null,{default:a(()=>[e(x,{class:"d-flex gap-x-3"},{default:a(()=>[e(A,{color:"primary",onClick:l[2]||(l[2]=u=>i.value=!0)},{default:a(()=>[m(" Add Member ")]),_:1})]),_:1}),e(x,{"offset-md":"4"},{default:a(()=>[e(P,{modelValue:o(f),"onUpdate:modelValue":l[3]||(l[3]=u=>Q(f)?f.value=u:null),density:"compact",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":"",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),e(V,{isDialogVisible:o(i),confirmationQuestion:"Add another member?",onConfirm:J,onCancel:l[4]||(l[4]=u=>i.value=!1)},null,8,["isDialogVisible"]),e(A,{class:"me-3 my-3 d-md-none",color:"primary",icon:"mdi-plus"})]),_:1})]),_:1}),e(O,null,{default:a(()=>[e(o(Ke),{headers:F,items:o(s).household_members,search:o(f)},{"item.actions":a(({item:u})=>[h("div",nt,[e(T,{onClick:p=>Z(u.raw.id)},{default:a(()=>[e(re,{icon:"mdi-delete-outline"})]),_:2},1032,["onClick"]),e(T,null,{default:a(()=>[e(q,{to:{name:"household-member-tab",params:{tab:"demographics"},query:{member_id:u.raw.id,household_id:u.raw.household_id}}},{default:a(()=>[e(re,{icon:`
                mdi-information-slab-circle-outline`})]),_:2},1032,["to"])]),_:2},1024)])]),"item.demographic.lastname":a(({item:u})=>[m(S(u.raw.demographic.lastname+", "+u.raw.demographic.firstname+" "+u.raw.demographic.middlename)+" ",1)]),"item.demographic.relationship":a(({item:u})=>{var p,y;return[m(S(((y=(p=o(N).filter(k=>k.column_number==="3")[0])==null?void 0:p.lookup_list.filter(k=>k.lookup_key===u.raw.demographic._3)[0])==null?void 0:y.description)||"Not Specified"),1)]}),"item.demographic.sex":a(({item:u})=>{var p,y;return[m(S(((y=(p=o(N).filter(k=>k.column_number==="5")[0])==null?void 0:p.lookup_list.filter(k=>k.lookup_key===u.raw.demographic._5)[0])==null?void 0:y.description)||"Not Specified"),1)]}),"item.demographic.age":a(({item:u})=>[m(S(new Date().getFullYear()-new Date(u.raw.demographic._6).getFullYear()-(new Date().getMonth()<new Date(u.raw.demographic._6).getMonth()||new Date().getMonth()===new Date(u.raw.demographic._6).getMonth()&&new Date().getDate()<new Date(u.raw.demographic._6).getDate()?1:0)),1)]),"item.demographic.tags":a(({item:u})=>[(C(!0),M(K,null,Me(u.raw.demographic.tags.split(","),(p,y)=>(C(),M("span",{key:y},[p.trim()=="alive"?(C(),M("span",ut,[e(oe,{color:"success",class:"font-weight-medium",size:"small"},{default:a(()=>[m(" Alive ")]),_:1})])):$("",!0),p.trim()=="teenage_pregnancy"?(C(),M("span",it,[e(oe,{color:"gray",class:"font-weight-medium",size:"small"},{default:a(()=>[m(" Teenage Pregnancy ")]),_:1})])):$("",!0),p.trim()=="dead"?(C(),M("span",rt,[e(oe,{color:"error",class:"font-weight-medium",size:"small"},{default:a(()=>[m(" Dead ")]),_:1})])):$("",!0)]))),128))]),_:1},8,["items","search"])]),_:1}),e(V,{isDialogVisible:o(r),confirmationQuestion:"This will be deleted permanently. Are you sure?",onConfirm:W,onCancel:l[5]||(l[5]=u=>r.value=!1)},null,8,["isDialogVisible"]),e(Oe,{modelValue:o(H),"onUpdate:modelValue":l[7]||(l[7]=u=>Q(H)?H.value=u:null),location:"top center",variant:"flat",color:o(z)},{actions:a(()=>[e(A,{color:"white",onClick:l[6]||(l[6]=u=>H.value=!1)},{default:a(()=>[m(" Close ")]),_:1})]),default:a(()=>[m(S(o(R))+" ",1)]),_:1},8,["modelValue","color"])]),_:1})):$("",!0)])}}});export{Nt as default};
