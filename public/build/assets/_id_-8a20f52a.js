import{_ as ye}from"./ConfirmDialog.vue_vue_type_script_setup_true_lang-969bb8dc.js";import{_ as xe}from"./SnackBar.vue_vue_type_script_setup_true_lang-011983f1.js";import{a as R}from"./axios-60a05fd8.js";import{a7 as Ve,ba as be,a9 as we,S as ee,k as c,av as ce,B as L,aw as ke,ab as Se,aG as Ce,p as e,G as ae,F as K,D as ue,b5 as Be,bb as De,aA as te,aI as Ne,b2 as He,aZ as Fe,d as me,A as fe,o as B,c as P,w as t,R as p,a0 as T,q as l,b as se,U as ne,$ as O,aF as Ie,O as z,Q,j as Re,r as le,ac as Ue,m as v,Y as Me,x as k,V as re,a as Pe}from"./main-fc279098.js";import{V as Y,a as x}from"./VRow-3d749928.js";import{a as Ae,e as Te,b as $e,c as de,f as ze,g as Ee,h as je,V as A}from"./VTextField-43358ead.js";import{f as qe}from"./forwardRefs-9d31fcaa.js";import{V as Ge}from"./VDialog-5a735d72.js";import{a as Le}from"./avatar-1-3f757947.js";import{a as Ke,V as oe}from"./VSelect-fb21050d.js";import{V as Oe}from"./VDataTable-bb1ff247.js";import{V as Qe}from"./VSnackbar-549b2369.js";import"./axios-4a70c6fc.js";import"./VOverlay-a6071b3b.js";import"./VDivider-5ecb6611.js";import"./VList-4e58f634.js";import"./ssrBoot-a8066742.js";import"./VMenu-50f2ce39.js";import"./VCheckboxBtn-235bdab6.js";import"./filter-918d2526.js";import"./VTable-59daa9b2.js";const Ye=Ve()({name:"VTextarea",directives:{Intersect:be},inheritAttrs:!1,props:{autoGrow:Boolean,autofocus:Boolean,counter:[Boolean,Number,String],counterValue:Function,prefix:String,placeholder:String,persistentPlaceholder:Boolean,persistentCounter:Boolean,noResize:Boolean,rows:{type:[Number,String],default:5,validator:a=>!isNaN(parseFloat(a))},maxRows:{type:[Number,String],validator:a=>!isNaN(parseFloat(a))},suffix:String,modelModifiers:Object,...Ae(),...Te()},emits:{"click:control":a=>!0,"mousedown:control":a=>!0,"update:focused":a=>!0,"update:modelValue":a=>!0},setup(a,D){let{attrs:U,emit:u,slots:n}=D;const f=we(a,"modelValue"),{isFocused:h,focus:N,blur:H}=$e(a),M=ee(()=>typeof a.counterValue=="function"?a.counterValue(f.value):(f.value||"").toString().length),b=ee(()=>{if(U.maxlength)return U.maxlength;if(!(!a.counter||typeof a.counter!="number"&&typeof a.counter!="string"))return a.counter});function r(o,m){var _,V;!a.autofocus||!o||(V=(_=m[0].target)==null?void 0:_.focus)==null||V.call(_)}const S=c(),d=c(),E=c(""),w=c(),j=ee(()=>h.value||a.persistentPlaceholder);function q(){var o;w.value!==document.activeElement&&((o=w.value)==null||o.focus()),h.value||N()}function Z(o){q(),u("click:control",o)}function J(o){u("mousedown:control",o)}function W(o){o.stopPropagation(),q(),te(()=>{f.value="",Ne(a["onClick:clear"],o)})}function X(o){var _;const m=o.target;if(f.value=m.value,(_=a.modelModifiers)!=null&&_.trim){const V=[m.selectionStart,m.selectionEnd];te(()=>{m.selectionStart=V[0],m.selectionEnd=V[1]})}}const F=c();function I(){a.autoGrow&&te(()=>{if(!F.value||!d.value)return;const o=getComputedStyle(F.value),m=getComputedStyle(d.value.$el),_=parseFloat(o.getPropertyValue("--v-field-padding-top"))+parseFloat(o.getPropertyValue("--v-input-padding-top"))+parseFloat(o.getPropertyValue("--v-field-padding-bottom")),V=F.value.scrollHeight,$=parseFloat(o.lineHeight),G=Math.max(parseFloat(a.rows)*$+_,parseFloat(m.getPropertyValue("--v-input-control-height"))),i=parseFloat(a.maxRows)*$+_||1/0;E.value=He(Fe(V??0,G,i))})}ce(I),L(f,I),L(()=>a.rows,I),L(()=>a.maxRows,I),L(()=>a.density,I);let s;return L(F,o=>{o?(s=new ResizeObserver(I),s.observe(F.value)):s==null||s.disconnect()}),ke(()=>{s==null||s.disconnect()}),Se(()=>{const o=!!(n.counter||a.counter||a.counterValue),m=!!(o||n.details),[_,V]=Ce(U),[{modelValue:$,...G}]=de.filterProps(a),[i]=ze(a);return e(de,ae({ref:S,modelValue:f.value,"onUpdate:modelValue":g=>f.value=g,class:["v-textarea v-text-field",{"v-textarea--prefixed":a.prefix,"v-textarea--suffixed":a.suffix,"v-text-field--prefixed":a.prefix,"v-text-field--suffixed":a.suffix,"v-textarea--auto-grow":a.autoGrow,"v-textarea--no-resize":a.noResize||a.autoGrow,"v-text-field--flush-details":["plain","underlined"].includes(a.variant)},a.class],style:a.style},_,G,{focused:h.value}),{...n,default:g=>{let{isDisabled:y,isDirty:C,isReadonly:pe,isValid:ge}=g;return e(Ee,ae({ref:d,style:{"--v-textarea-control-height":E.value},onClick:Z,onMousedown:J,"onClick:clear":W,"onClick:prependInner":a["onClick:prependInner"],"onClick:appendInner":a["onClick:appendInner"],role:"textbox"},i,{active:j.value||C.value,dirty:C.value||a.dirty,disabled:y.value,focused:h.value,error:ge.value===!1}),{...n,default:he=>{let{props:{class:ie,...ve}}=he;return e(K,null,[a.prefix&&e("span",{class:"v-text-field__prefix"},[a.prefix]),ue(e("textarea",ae({ref:w,class:ie,value:f.value,onInput:X,autofocus:a.autofocus,readonly:pe.value,disabled:y.value,placeholder:a.placeholder,rows:a.rows,name:a.name,onFocus:q,onBlur:H},ve,V),null),[[Be("intersect"),{handler:r},null,{once:!0}]]),a.autoGrow&&ue(e("textarea",{class:[ie,"v-textarea__sizer"],"onUpdate:modelValue":_e=>f.value=_e,ref:F,readonly:!0,"aria-hidden":"true"},null),[[De,f.value]]),a.suffix&&e("span",{class:"v-text-field__suffix"},[a.suffix])])}})},details:m?g=>{var y;return e(K,null,[(y=n.details)==null?void 0:y.call(n,g),o&&e(K,null,[e("span",null,null),e(je,{active:a.persistentCounter||h.value,value:M.value,max:b.value},n.counter)])])}:void 0})}),qe({},S,d,w)}}),Ze=me({__name:"EditHouseholdDialog",props:["householdData"],emits:["finish"],setup(a,{emit:D}){const U=a,u=c(!1),n=c(),f=c(),h=c(!1),N=fe(),H=()=>{u.value=!0,n.value={...U.householdData}},M=async()=>{h.value=!0;try{const b=await R.put(`/api/household/${N.query.household_id}`,{barangay:n.value.Barangay,sitio:n.value.sitio,husn:n.value.HUSN,bsn:n.value.BSN,hsn:n.value.HSN,address:n.value.address});D("finish"),f.value.show("success",b.data.message)}catch(b){f.value.show("error",b)}u.value=!1,h.value=!1};return(b,r)=>{const S=xe;return B(),P("div",null,[e(S,{ref_key:"SnackBarRef",ref:f},null,512),e(T,{onClick:H,block:""},{default:t(()=>[p("Edit")]),_:1}),e(Ge,{modelValue:l(u),"onUpdate:modelValue":r[8]||(r[8]=d=>Q(u)?u.value=d:null),"max-width":"800"},{default:t(()=>[l(n)?(B(),se(ne,{key:0,title:"Edit Household"},{default:t(()=>[e(O,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(x,{cols:"12"},{default:t(()=>[e(A,{label:"Household Key",disabled:"",modelValue:l(n).HouseholdKey,"onUpdate:modelValue":r[0]||(r[0]=d=>l(n).HouseholdKey=d)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"4"},{default:t(()=>[e(A,{label:"HSN",modelValue:l(n).HSN,"onUpdate:modelValue":r[1]||(r[1]=d=>l(n).HSN=d)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"4"},{default:t(()=>[e(A,{label:"BSN",modelValue:l(n).BSN,"onUpdate:modelValue":r[2]||(r[2]=d=>l(n).BSN=d)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"4"},{default:t(()=>[e(A,{label:"HUSN",modelValue:l(n).HUSN,"onUpdate:modelValue":r[3]||(r[3]=d=>l(n).HUSN=d)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"4"},{default:t(()=>[e(A,{label:"Baranggay",modelValue:l(n).Barangay,"onUpdate:modelValue":r[4]||(r[4]=d=>l(n).Barangay=d)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12",md:"4"},{default:t(()=>[e(A,{label:"Sitio",modelValue:l(n).sitio,"onUpdate:modelValue":r[5]||(r[5]=d=>l(n).sitio=d)},null,8,["modelValue"])]),_:1}),e(x,{cols:"12"},{default:t(()=>[e(Ye,{label:"Address",modelValue:l(n).address,"onUpdate:modelValue":r[6]||(r[6]=d=>l(n).address=d)},null,8,["modelValue"])]),_:1})]),_:1})]),_:1}),e(Ie,{class:"d-flex justify-end"},{default:t(()=>[e(T,{onClick:r[7]||(r[7]=d=>u.value=!1)},{default:t(()=>[p(" Cancel ")]),_:1}),e(T,{variant:"elevated",onClick:M,loading:l(h)},{default:t(()=>[p(" Save ")]),_:1},8,["loading"])]),_:1})]),_:1})):z("",!0)]),_:1},8,["modelValue"])])}}}),Je="/build/assets/background-1-ceba94e3.jpg",We={class:"d-flex h-0"},Xe={class:"user-profile-info w-100 mt-16 pt-6 pt-sm-0 mt-sm-0"},ea={class:"d-flex align-center justify-center justify-sm-space-between flex-wrap gap-4"},aa={class:"d-flex gap-x-5"},ta={class:"d-flex align-center"},la={class:"d-flex align-center"},oa={class:"d-flex align-center"},sa={class:"d-flex align-center"},na={class:"d-flex"},ia={class:"d-flex px-auto gap-1"},ua={key:0},ra={key:1},da={key:2},Ia=me({__name:"[id]",setup(a){const D=fe(),U=Re(),u=c(),n=c();c(97);const f=c(),h=c(),N=c([]),H=c(!1),M=c(!1),b=c(!1),r=c(null),S=c(!1),d=c(),E=c(),w=s=>{d.value=s.message,E.value=s.type,S.value=!0};async function j(){try{const s=D.params.id,o=await R.get("/api/household-list",{params:{id:D.query.household_id}});u.value=o.data,h.value=u.value.household_container.id}catch(s){console.log(s)}try{const s=await R.get("/api/container");n.value=s.data}catch(s){console.error(s)}}async function q(){try{const s=await R.get("/api/lookup/");N.value=s.data}catch(s){console.error("Error fetching lookups:",s)}}const Z=async()=>{H.value=!0;try{const s=await R.put(`/api/household/${D.query.household_id}/update-container`,{container_id:h.value});w({message:s.data.message,type:"success"}),H.value=!1}catch(s){w({message:s,type:"error"}),H.value=!1}};async function J(){try{const s=await R.post("/api/addMember",{household_id:D.query.household_id});U.push("/household/member/demographics?member_id="+s.data.household_member_id+"&household_id="+D.query.household_id)}catch(s){console.log(s)}}const W=async()=>{try{await R.delete("/api/household/member",{data:{household_member_id:r.value}}),w({message:"Household member successfully deleted",type:"success"}),j()}catch(s){w({message:s.response.data.message,type:"warning"})}r.value=null,b.value=!1},X=s=>{r.value=s,b.value=!0},F=[{title:"Full Name",key:"name"},{title:"Relationship",key:"demographic.relationship"},{title:"Sex",key:"demographic.sex"},{title:"Age",key:"demographic.age"},{title:"Status",key:"demographic.tags"},{title:"Action",key:"actions"}];ce(()=>{j(),q()});const I=async(s,o)=>{try{const m=await R.put("/api/household/survey-status",{household_id:s,surveyStatus:!o});w({message:m.data.message,type:"success"}),u.value.surveyStatus=!o}catch(m){w({message:m.response.data.message,type:"error"})}};return(s,o)=>{const m=le("VText"),_=Ze,V=ye,$=le("IconBtn"),G=le("RouterLink");return B(),P("section",null,[l(u)&&l(N)?(B(),se(ne,{key:0},{default:t(()=>[e(Ue,{src:l(Je),"min-height":"125","max-height":"175",cover:""},null,8,["src"]),e(O,{class:"d-flex align-bottom flex-sm-row flex-column justify-center gap-x-4",style:{"min-height":"125px"}},{default:t(()=>[v("div",We,[e(Me,{rounded:"",size:"125",image:l(Le),class:"user-profile-avatar mx-auto"},null,8,["image"])]),v("div",Xe,[v("div",ea,[e(Y,null,{default:t(()=>[e(x,{cols:"12",sm:"8",class:"d-flex flex-column"},{default:t(()=>[v("div",aa,[v("span",ta,[e(m,null,{default:t(()=>[p("Brgy (Purok/Sitio): "),v("b",null,k(l(u).Barangay),1)]),_:1})]),v("span",la,[e(m,null,{default:t(()=>[p("BSN: "),v("b",null,k(l(u).BSN),1)]),_:1})]),v("span",oa,[e(m,null,{default:t(()=>[p("HUSN: "),v("b",null,k(l(u).HUSN),1)]),_:1})]),v("span",sa,[e(m,null,{default:t(()=>[p("HSN: "),v("b",null,k(l(u).HSN),1)]),_:1})])]),v("div",na,[e(m,null,{default:t(()=>[p("Complete Address: "),v("b",null,k(l(u).address),1)]),_:1})])]),_:1}),e(x,{class:"d-flex flex-column gap-y-2",cols:"12",sm:"4"},{default:t(()=>[e(Y,null,{default:t(()=>[e(x,null,{default:t(()=>[e(Ke,{modelValue:l(h),"onUpdate:modelValue":[o[0]||(o[0]=i=>Q(h)?h.value=i:null),Z],items:l(n),"item-title":"name","item-value":"id",density:"compact",label:"Folder",loading:l(H)},null,8,["modelValue","items","loading"])]),_:1}),e(x,null,{default:t(()=>[e(_,{"household-data":l(u),onFinish:j},null,8,["household-data"])]),_:1})]),_:1}),e(T,{onClick:o[1]||(o[1]=()=>{I(l(u).id,l(u).surveyStatus)}),color:l(u).surveyStatus?"success":"warning"},{default:t(()=>[p(k(l(u).surveyStatus?"Completed":"Mark as Complete"),1)]),_:1},8,["color"])]),_:1})]),_:1})])])]),_:1})]),_:1})):z("",!0),l(u)?(B(),se(ne,{key:1,class:"mt-3"},{default:t(()=>[e(O,null,{default:t(()=>[e(Y,null,{default:t(()=>[e(x,{class:"d-flex gap-x-3"},{default:t(()=>[e(T,{color:"primary",onClick:o[2]||(o[2]=i=>M.value=!0)},{default:t(()=>[p(" Add Member ")]),_:1})]),_:1}),e(x,{"offset-md":"4"},{default:t(()=>[e(A,{modelValue:l(f),"onUpdate:modelValue":o[3]||(o[3]=i=>Q(f)?f.value=i:null),density:"compact",label:"Search","append-inner-icon":"mdi-magnify","single-line":"","hide-details":"",dense:"",outlined:""},null,8,["modelValue"])]),_:1}),e(V,{isDialogVisible:l(M),confirmationQuestion:"Add another member?",onConfirm:J,onCancel:o[4]||(o[4]=i=>M.value=!1)},null,8,["isDialogVisible"]),e(T,{class:"me-3 my-3 d-md-none",color:"primary",icon:"mdi-plus"})]),_:1})]),_:1}),e(O,null,{default:t(()=>[e(l(Oe),{headers:F,items:l(u).household_members,search:l(f)},{"item.actions":t(({item:i})=>[v("div",ia,[e($,{onClick:g=>X(i.raw.id)},{default:t(()=>[e(re,{icon:"mdi-delete-outline"})]),_:2},1032,["onClick"]),e($,null,{default:t(()=>[e(G,{to:{name:"household-member-tab",params:{tab:"demographics"},query:{member_id:i.raw.id,household_id:i.raw.household_id}}},{default:t(()=>[e(re,{icon:`
                mdi-information-slab-circle-outline`})]),_:2},1032,["to"])]),_:2},1024)])]),"item.name":t(({item:i})=>[p(k(i.raw.demographic.lastname+", "+i.raw.demographic.firstname+" "+i.raw.demographic.middlename),1)]),"item.demographic.relationship":t(({item:i})=>{var g,y;return[p(k(((y=(g=l(N).filter(C=>C.column_number==="3")[0])==null?void 0:g.lookup_list.filter(C=>C.lookup_key===i.raw.demographic._3)[0])==null?void 0:y.description)||"Not Specified"),1)]}),"item.demographic.sex":t(({item:i})=>{var g,y;return[p(k(((y=(g=l(N).filter(C=>C.column_number==="5")[0])==null?void 0:g.lookup_list.filter(C=>C.lookup_key===i.raw.demographic._5)[0])==null?void 0:y.description)||"Not Specified"),1)]}),"item.demographic.age":t(({item:i})=>[p(k(new Date().getFullYear()-new Date(i.raw.demographic._6).getFullYear()-(new Date().getMonth()<new Date(i.raw.demographic._6).getMonth()||new Date().getMonth()===new Date(i.raw.demographic._6).getMonth()&&new Date().getDate()<new Date(i.raw.demographic._6).getDate()?1:0)),1)]),"item.demographic.tags":t(({item:i})=>[(B(!0),P(K,null,Pe(i.raw.demographic.tags.split(","),(g,y)=>(B(),P("span",{key:y},[g.trim()=="alive"?(B(),P("span",ua,[e(oe,{color:"success",class:"font-weight-medium",size:"small"},{default:t(()=>[p(" Alive ")]),_:1})])):z("",!0),g.trim()=="teenage_pregnancy"?(B(),P("span",ra,[e(oe,{color:"gray",class:"font-weight-medium",size:"small"},{default:t(()=>[p(" Teenage Pregnancy ")]),_:1})])):z("",!0),g.trim()=="dead"?(B(),P("span",da,[e(oe,{color:"error",class:"font-weight-medium",size:"small"},{default:t(()=>[p(" Deceased ")]),_:1})])):z("",!0)]))),128))]),_:1},8,["items","search"])]),_:1}),e(V,{isDialogVisible:l(b),confirmationQuestion:"This will be deleted permanently. Are you sure?",onConfirm:W,onCancel:o[5]||(o[5]=i=>b.value=!1)},null,8,["isDialogVisible"]),e(Qe,{modelValue:l(S),"onUpdate:modelValue":o[7]||(o[7]=i=>Q(S)?S.value=i:null),location:"top center",variant:"flat",color:l(E)},{actions:t(()=>[e(T,{color:"white",onClick:o[6]||(o[6]=i=>S.value=!1)},{default:t(()=>[p(" Close ")]),_:1})]),default:t(()=>[p(k(l(d))+" ",1)]),_:1},8,["modelValue","color"])]),_:1})):z("",!0)])}}});export{Ia as default};
